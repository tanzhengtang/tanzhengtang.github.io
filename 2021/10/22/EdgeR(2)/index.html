<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,minimum-scale=1,user-scalable=no,minimal-ui"><meta name="renderer" content="webkit"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><meta name="format-detection" content="telephone=no,email=no,adress=no"><meta name="theme-color" content="#000000"><meta http-equiv="window-target" content="_top"><title>EdgeR查找差异表达基因(二) | Tan&#39;s Blog</title><meta name="description" content="EdgeR查找差异表达基因(二)  前言 第一篇有关于EdgeR处理差异基因的过程中有瑕疵的，这篇文章一是要提出上次过程中没写出的问题，二是要写出有关EdgeR原理方面的东西。  数据来源 癌症细胞：Encode上HepG2癌症细胞系total RNA-Seq的基因定量文件。 正常细胞：Encode上正常肝组织的total RNA-Seq的基因定量文件。  流程中的问题  基因定量信息 上次使用"><meta property="og:type" content="article"><meta property="og:title" content="EdgeR查找差异表达基因(二)"><meta property="og:url" content="https://tanzhengtang.github.io/2021/10/22/EdgeR(2)/index.html"><meta property="og:site_name" content="Tan&#39;s Blog"><meta property="og:description" content="EdgeR查找差异表达基因(二)  前言 第一篇有关于EdgeR处理差异基因的过程中有瑕疵的，这篇文章一是要提出上次过程中没写出的问题，二是要写出有关EdgeR原理方面的东西。  数据来源 癌症细胞：Encode上HepG2癌症细胞系total RNA-Seq的基因定量文件。 正常细胞：Encode上正常肝组织的total RNA-Seq的基因定量文件。  流程中的问题  基因定量信息 上次使用"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://tanzhengtang.github.io/2021/10/22/EdgeR(2)/1.png"><meta property="article:published_time" content="2021-10-21T16:00:00.000Z"><meta property="article:modified_time" content="2023-03-25T09:15:32.933Z"><meta property="article:author" content="Zhengtang Tan"><meta property="article:tag" content="RNA-Seq"><meta property="article:tag" content="DE-Analysis"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://tanzhengtang.github.io/2021/10/22/EdgeR(2)/1.png"><link rel="canonical" href="https://tanzhengtang.github.io/2021/10/22/EdgeR(2)/index.html"><link rel="icon" href="/favicon.png" type="image/x-icon"><link rel="stylesheet" href="/css/style.css"><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="Tan's Blog" type="application/atom+xml"></head><body class="main-center theme-black" itemscope itemtype="http://schema.org/WebPage"><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="slimContent"><div class="navbar-header"><div class="profile-block text-center"><a id="avatar" href="https://github.com/tanzhengtang" target="_blank"><img class="img-circle img-rotate" src="/images/avatar.jpg" width="200" height="200"></a><h2 id="name" class="hidden-xs hidden-sm">Tan</h2><h3 id="title" class="hidden-xs hidden-sm hidden-md"></h3><small id="location" class="text-muted hidden-xs hidden-sm"><i class="icon icon-map-marker"></i> Chengdu, China</small></div><div class="search" id="search-form-wrap"><form class="search-form sidebar-form"><div class="input-group"><input type="text" class="search-form-input form-control" placeholder="Search"> <span class="input-group-btn"><button type="submit" class="search-form-submit btn btn-flat" onclick="return!1"><i class="icon icon-search"></i></button></span></div></form><div class="ins-search"><div class="ins-search-mask"></div><div class="ins-search-container"><div class="ins-input-wrapper"><input type="text" class="ins-search-input" placeholder="Type something..." x-webkit-speech> <button type="button" class="close ins-close ins-selectable" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button></div><div class="ins-section-wrapper"><div class="ins-section-container"></div></div></div></div></div><button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target="#main-navbar" aria-controls="main-navbar" aria-expanded="false"><span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span></button></div><nav id="main-navbar" class="collapse navbar-collapse" itemscope itemtype="http://schema.org/SiteNavigationElement" role="navigation"><ul class="nav navbar-nav main-nav"><li class="menu-item menu-item-home"><a href="/."><i class="icon icon-home-fill"></i> <span class="menu-title">Home</span></a></li></ul><ul class="social-links"><li><a href="https://github.com/tanzhengtang" target="_blank" title="Github" data-toggle="tooltip" data-placement="top"><i class="icon icon-github"></i></a></li></ul></nav></div></header><aside class="sidebar" itemscope itemtype="http://schema.org/WPSideBar"><div class="slimContent"><div class="widget"><h3 class="widget-title">Board</h3><div class="widget-body"><div id="board"><div class="content"><p>A Bioinformatics Newbee Site</p></div></div></div></div><div class="widget"><h3 class="widget-title">Categories</h3><div class="widget-body"><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Algorithm/">Algorithm</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Bioinformatics/">Bioinformatics</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Blog/">Blog</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Computer/">Computer</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Math/">Math</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Statistical-Learning-Methods/">Statistical Learning Methods</a><span class="category-list-count">1</span></li></ul></div></div></div></aside><main class="main" role="main"><div class="content"><article id="post-EdgeR(2)" class="article article-type-post" itemscope itemtype="http://schema.org/BlogPosting"><div class="article-header"><h1 class="article-title" itemprop="name">EdgeR查找差异表达基因(二)</h1><div class="article-meta"><span class="article-date"><i class="icon icon-calendar-check"></i> <a href="/2021/10/22/EdgeR(2)/" class="article-date"><time datetime="2021-10-21T16:00:00.000Z" itemprop="datePublished">2021-10-22</time> </a></span><span class="article-category"><i class="icon icon-folder"></i> <a class="article-category-link" href="/categories/Bioinformatics/">Bioinformatics</a> </span><span class="article-tag"><i class="icon icon-tags"></i> <a class="article-tag-link-link" href="/tags/DE-Analysis/" rel="tag">DE-Analysis</a>, <a class="article-tag-link-link" href="/tags/RNA-Seq/" rel="tag">RNA-Seq</a> </span><span class="article-read hidden-xs"><i class="icon icon-eye-fill" aria-hidden="true"></i> <span id="/2021/10/22/EdgeR(2)/" class="leancloud_visitors" data-flag-title="EdgeR查找差异表达基因(二)">0</span> </span><span class="post-comment"><i class="icon icon-comment"></i> <a href="/2021/10/22/EdgeR(2)/#comments" class="article-comment-link">Comments</a></span> <span class="post-wordcount hidden-xs" itemprop="wordCount">Word Count: 512(words)</span> <span class="post-readcount hidden-xs" itemprop="timeRequired">Read Count: 2(minutes)</span></div></div><div class="article-entry marked-body" itemprop="articleBody"><h1 id="edger查找差异表达基因二"><a class="markdownIt-Anchor" href="#edger查找差异表达基因二"></a> EdgeR查找差异表达基因(二)</h1><h2 id="前言"><a class="markdownIt-Anchor" href="#前言"></a> 前言</h2><p>第一篇有关于EdgeR处理差异基因的过程中有瑕疵的，这篇文章一是要提出上次过程中没写出的问题，二是要写出有关EdgeR原理方面的东西。</p><h2 id="数据来源"><a class="markdownIt-Anchor" href="#数据来源"></a> 数据来源</h2><p>癌症细胞：<code>Encode</code>上<code>HepG2</code>癌症细胞系<code>total RNA-Seq</code>的基因定量文件。<br>正常细胞：<code>Encode</code>上正常肝组织的<code>total RNA-Seq</code>的基因定量文件。</p><h2 id="流程中的问题"><a class="markdownIt-Anchor" href="#流程中的问题"></a> 流程中的问题</h2><h3 id="基因定量信息"><a class="markdownIt-Anchor" href="#基因定量信息"></a> 基因定量信息</h3><p>上次使用了<code>Encode</code>的基因定量文件中<code>gene_id</code>和<code>expected_count</code>两列组成EdgeR的输入数据文件。这样直接使用是粗糙的。<br><code>下载的ENSG数据中常常有小数点，小数点后面的表示的版本类型，在进行匹配时需要删除小数点后面的，一般情况下ENSG一共是15位，所有保留前15位字符就可以了.</code><br><strong>读入数据:</strong></p><blockquote><p>rep1=read.table(“./ENCFF944RFV.tsv”,header=T)<br>rep2=read.table(“./ENCFF529HSE.tsv”,header=T)<br>rep3=read.table(“./ENCFF396FZT.tsv”,header=T)<br>rep4=read.table(“./ENCFF103FSL.tsv”,header=T)<br>norm1=read.table(“~/Project/Normal_tissue/Liver/RNA/ENCFF780YUS.tsv”,header = T)<br>norm2=read.table(“~/Project/Normal_tissue/Liver/RNA/ENCFF846SOK.tsv”,header = T)</p></blockquote><p><strong>处理gene_id:</strong><br>以rep1为例:</p><blockquote><p>rep1 = rep1[grep(‘ENSG’,test$gene_id,invert = F),]<br>rep1$gene_id = substr(rep1$gene_id,1,15)<br>rep1 = aggregate(expected_count ~ gene_id , data = rep1,sum)</p></blockquote><p>将其他的rep和norm作同样的处理</p><p><strong>得到矩阵:</strong></p><blockquote><p>count=data.frame(rep1$gene_id,rep1$expected_count,rep2$expected_count,rep3$expected_count,rep4$expected_count,norm1$expected_count,norm2$expected_count)<br>colnames(count)=c(‘gene_id’,‘rep1’,‘rep2’,‘rep3’,‘rep4’,‘norm1’,‘norm2’)<br>rownames(count)=count$gene_id<br>count = count[,-c(1)]</p></blockquote><p>原始矩阵count:</p><p><img src="/2021/10/22/EdgeR(2)/1.png" alt></p><p><strong>分组:</strong></p><p><code>分组</code>步骤同后面的流程息息相关。<br>它会影响<code>过滤低表达基因</code>和<code>检验差异基因</code>。<br>1.在<code>过滤表达基因</code>部分:<br><code>The filtering should be based on the grouping factors or treatment factors that will be involved in the differential expression teststested for, rather than on blocking variables that are not of scientific interest in themselves.</code><br>2.在<code>检验差异基因</code>部分:<br>(1) 单因子分组实验:<code>The classic edgeR pipeline</code>—&gt;<code>edgeR uses the quantile-adjusted conditional maximum likelihood (qCML) method for experiments with single factor.</code><br>(2) 多因子复杂分组:<code>More complex experiments (glm functionality)</code>—&gt;<code>Generalized linear models (GLMs) are an extension of classical linear models to nonnormally distributed response data</code></p></div><div class="article-footer"><div class="panel panel-default panel-badger"><div class="panel-body"><figure class="media"><div class="media-left"><a href="https://github.com/tanzhengtang" target="_blank" class="img-burn thumb-sm visible-lg"><img src="/images/avatar.jpg" class="img-rounded w-full" alt=""></a></div><div class="media-body"><h3 class="media-heading"><a href="https://github.com/tanzhengtang" target="_blank"><span class="text-dark">Tan</span><small class="ml-1x"></small></a></h3><div>Novice Bioinformatics Prcatitioners</div></div></figure></div></div></div></article><section id="comments"><div id="vcomments"></div></section></div><nav class="bar bar-footer clearfix" data-stick-bottom><div class="bar-inner"><ul class="pager pull-left"><li class="prev"><a href="/2022/04/05/riskfunction/" title="统计学习方法三要素"><i class="icon icon-angle-left" aria-hidden="true"></i><span>&nbsp;&nbsp;Newer</span></a></li><li class="next"><a href="/2021/10/09/clusterProfiler/" title="clusterProfiler进行GO、KEGG以及相应的可视化"><span>Older&nbsp;&nbsp;</span><i class="icon icon-angle-right" aria-hidden="true"></i></a></li></ul><div class="bar-right"><div class="share-component" data-sites="weibo,qq,wechat,facebook,twitter" data-mobile-sites="weibo,qq,qzone"></div></div></div></nav></main><footer class="footer" itemscope itemtype="http://schema.org/WPFooter"><ul class="social-links"><li><a href="https://github.com/tanzhengtang" target="_blank" title="Github" data-toggle="tooltip" data-placement="top"><i class="icon icon-github"></i></a></li></ul><div class="copyright">&copy; 2023 Zhengtang Tan</div></footer><script src="//cdn.jsdelivr.net/npm/jquery@1.12.4/dist/jquery.min.js"></script><script>window.jQuery||document.write('<script src="js/jquery.min.js"><\/script>')</script><script src="/js/plugin.min.js"></script><script src="/js/application.js"></script><script>window.INSIGHT_CONFIG={TRANSLATION:{POSTS:"Posts",PAGES:"Pages",CATEGORIES:"Categories",TAGS:"Tags",UNTITLED:"(Untitled)"},ROOT_URL:"/",CONTENT_URL:"/content.json"}</script><script src="/js/insight.js"></script><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//cdn.jsdelivr.net/npm/valine"></script><script type="text/javascript">var GUEST=["nick","mail","link"],meta=(meta="nick,mail,link").split(",").filter(function(e){return-1<GUEST.indexOf(e)});new Valine({el:"#vcomments",verify:!1,notify:!1,appId:"YjBymcMiGsjo3pWP3tw28vfR-gzGzoHsz",appKey:"1svA3cllqE0cfrMPv2m1w8po",placeholder:"Just say something",avatar:"mp",meta:meta,pageSize:"10",visitor:!0,lang:"en"})</script></body></html>